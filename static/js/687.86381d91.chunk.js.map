{"version":3,"file":"static/js/687.86381d91.chunk.js","mappings":"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","sources":["webpack://demos/./src/PageGradientScroll/index.module.css?7b7e","PageGradientScroll/data.ts","PageGradientScroll/index.tsx","PageGradientScroll/utils/imageToDataUri.ts","PageGradientScroll/utils/getAverageColorOfImage.ts","PageGradientScroll/utils/isDarkColor.ts"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"navbar\":\"PageGradientScroll_navbar__qjoy+\",\"wrap\":\"PageGradientScroll_wrap__OyIwd\",\"bgImage\":\"PageGradientScroll_bgImage__bTqO5\",\"bgImageMask\":\"PageGradientScroll_bgImageMask__COTpi\",\"tab\":\"PageGradientScroll_tab__4X4i8\",\"tabInner\":\"PageGradientScroll_tabInner__zm0aV\",\"tabItem\":\"PageGradientScroll_tabItem__YRTNd\",\"tabActive\":\"PageGradientScroll_tabActive__EiApL\",\"content\":\"PageGradientScroll_content__xhd+W\",\"contentInner\":\"PageGradientScroll_contentInner__Z-gYt\",\"contentItem\":\"PageGradientScroll_contentItem__N0x8b\"};","export const images = [\n  {\n    name: 'mountains',\n    url: 'https://cdn.jsdelivr.net/gh/Gaohaoyang/pics/demos/mountains.png',\n  },\n  {\n    name: 'clouds',\n    url: 'https://cdn.jsdelivr.net/gh/Gaohaoyang/pics/demos/clouds.png',\n  },\n  {\n    name: 'stars',\n    url: 'https://cdn.jsdelivr.net/gh/Gaohaoyang/pics/demos/stars.png',\n  },\n  {\n    name: 'convertible car',\n    url: 'https://cdn.jsdelivr.net/gh/Gaohaoyang/pics/demos/convertibleCar.png',\n  },\n  {\n    name: 'forest',\n    url: 'https://cdn.jsdelivr.net/gh/Gaohaoyang/pics/demos/forest.png',\n  },\n  {\n    name: 'furniture',\n    url: 'https://cdn.jsdelivr.net/gh/Gaohaoyang/pics/demos/furniture.png',\n  },\n  {\n    name: 'ice cream',\n    url: 'https://cdn.jsdelivr.net/gh/Gaohaoyang/pics/demos/iceCream.png',\n  },\n  {\n    name: 'phone',\n    url: 'https://cdn.jsdelivr.net/gh/Gaohaoyang/pics/demos/phone.png',\n  },\n  {\n    name: 'squirrel',\n    url: 'https://cdn.jsdelivr.net/gh/Gaohaoyang/pics/demos/squirrel.png',\n  },\n  {\n    name: 'sunset',\n    url: 'https://cdn.jsdelivr.net/gh/Gaohaoyang/pics/demos/sunset.png',\n  },\n]\n\n// export const tabsName = [\n//   'Lorem',\n//   'Ipsum',\n//   'Consectetur',\n//   'Vitae',\n//   'Maecenas',\n//   'Sit',\n//   'Donec',\n//   'Sed',\n// ]\n","import React, { useState, useRef, useEffect } from 'react'\nimport styles from './index.module.css'\nimport { images } from './data'\nimport { imageToDataUri, getAverageColor, isDarkColor } from './utils'\n\nconst imageHeightPx = (window.innerWidth / 16) * 9\n// const randomImageIndex = Math.floor(Math.random() * images.length)\nconst navBarHeightPx = 60\n\nfunction PageGradientScroll() {\n  const [currentTab, setCurrentTab] = useState(0)\n  const [isDarkBgColor, setIsDarkBgColor] = useState(false)\n  const [averageColor, setAverageColor] = useState<[number, number, number]>([255, 255, 255])\n  const tabRef = useRef<HTMLDivElement>(null)\n  const bgImageMaskRef = useRef<HTMLDivElement>(null)\n  const navbarRef = useRef<HTMLDivElement>(null)\n\n  const listenWindowScroll = () => {\n    window.addEventListener('scroll', () => {\n      if (!bgImageMaskRef.current) {\n        return\n      }\n      if (!navbarRef.current) {\n        return\n      }\n      const threshold = imageHeightPx - navBarHeightPx\n      const scrollTop = document.documentElement.scrollTop || document.body.scrollTop\n      if (scrollTop >= threshold) {\n        bgImageMaskRef.current.style.opacity = '1'\n        bgImageMaskRef.current.style.height = `${navBarHeightPx + 20}px`\n        navbarRef.current.style.opacity = '1'\n      } else {\n        bgImageMaskRef.current.style.opacity = `${scrollTop / threshold}`\n        bgImageMaskRef.current.style.height = `${imageHeightPx - scrollTop}px`\n        navbarRef.current.style.opacity = `${scrollTop / threshold}`\n      }\n    })\n  }\n\n  const getAverageColorAndDetectDark = (index: number) => {\n    imageToDataUri(images[index].url).then((dataUri) => {\n      const imgElement = document.createElement('img')\n      imgElement.src = dataUri\n      imgElement.onload = () => {\n        const average = getAverageColor(imgElement)\n        setAverageColor(average)\n        if (isDarkColor(average)) {\n          setIsDarkBgColor(true)\n        } else {\n          setIsDarkBgColor(false)\n        }\n      }\n    })\n  }\n\n  /**\n   * This code handles the click event for the tab buttons.\n   * It also scrolls the tab buttons to the center of the screen.\n   */\n  const handleClickTab = (index: number) => {\n    setCurrentTab(index)\n    if (tabRef.current) {\n      const halfScreenWidth = window.innerWidth / 2\n      const currentTabHalfWidth = (tabRef.current.children[index] as HTMLElement).offsetWidth / 2\n\n      const left = (tabRef.current.children[index] as HTMLElement).offsetLeft\n        - halfScreenWidth\n        + currentTabHalfWidth\n\n      tabRef.current.scroll({\n        left,\n        behavior: 'smooth',\n      })\n    }\n  }\n\n  useEffect(() => {\n    listenWindowScroll()\n  }, [])\n\n  useEffect(() => {\n    getAverageColorAndDetectDark(currentTab)\n  }, [currentTab])\n\n  return (\n    <div\n      style={\n        {\n          backgroundColor: `rgb(${averageColor[0]}, ${averageColor[1]}, ${averageColor[2]})`,\n        }\n      }\n    >\n      <div\n        className={styles.navbar}\n        style={{\n          height: navBarHeightPx,\n          color: isDarkBgColor ? '#fff' : '#111',\n        }}\n        ref={navbarRef}\n      >\n        Page Gradient Scroll\n      </div>\n      <div\n        className={styles.bgImage}\n        style={{\n          height: imageHeightPx,\n          backgroundImage: `url(${images[currentTab].url})`,\n        }}\n      />\n      <div\n        className={styles.bgImageMask}\n        ref={bgImageMaskRef}\n        style={{\n          height: imageHeightPx,\n          backgroundColor: `rgb(${averageColor[0]}, ${averageColor[1]}, ${averageColor[2]})`,\n        }}\n      />\n      <div className={styles.wrap}>\n        <div\n          className={styles.bgPadding}\n          style={{\n            height: imageHeightPx - 20,\n          }}\n        />\n        <div\n          className={styles.tab}\n          style={{\n            top: navBarHeightPx,\n          }}\n        >\n          <div\n            className={styles.tabInner}\n            ref={tabRef}\n            style={{\n              backgroundColor: `rgba(${averageColor[0]}, ${averageColor[1]}, ${averageColor[2]}, 0.4)`,\n            }}\n          >\n            {images.map((item, index) => (\n              <button\n                key={item.name}\n                className={`${styles.tabItem} ${currentTab === index ? styles.tabActive : ''}`}\n                onClick={() => {\n                  handleClickTab(index)\n                }}\n                type=\"button\"\n              >\n                {item.name}\n              </button>\n            ))}\n          </div>\n        </div>\n        <div className={styles.content}>\n          <div\n            className={styles.contentInner}\n            style={{\n              backgroundColor: `rgba(${averageColor[0]}, ${averageColor[1]}, ${averageColor[2]}, 0.3)`,\n            }}\n          >\n            {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((item) => (\n              <div className={styles.contentItem} key={item}>\n                {item}\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default PageGradientScroll\n","/* eslint-disable max-len */\n/**\n * convert the image to a data URI\n */\nexport const imageToDataUri: (url: string) => Promise<string> = (url) => new Promise((resolve, reject) => {\n  const xhr = new XMLHttpRequest()\n  xhr.onload = () => {\n    const reader = new FileReader()\n    reader.onloadend = () => {\n      resolve(reader.result as string)\n    }\n    reader.readAsDataURL(xhr.response)\n  }\n  xhr.onerror = (e) => {\n    console.error('An error occurred while transferring the image.', e)\n    reject(e)\n  }\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.send()\n})\n","/* eslint-disable max-len */\n/**\n * get average color of an image\n */\nexport const getAverageColor: (img: HTMLImageElement) => [number, number, number] = (img) => {\n  const canvas = document.createElement('canvas')\n  canvas.width = img.width\n  canvas.height = img.height\n  const context = canvas.getContext('2d')\n\n  if (!context) return [255, 255, 255]\n\n  context.drawImage(img, 0, 0)\n  const imageData = context.getImageData(0, 0, canvas.width, canvas.height)\n  const { data } = imageData\n  let r = 0\n  let g = 0\n  let b = 0\n  let count = 0\n  // 每隔多个像素取一个点，减少计算量，提升性能\n  for (let y = 0; y < canvas.height; y += 50) {\n    for (let x = 0; x < canvas.width; x += 50) {\n      const index = (y * canvas.width + x) * 4\n      r += data[index]\n      g += data[index + 1]\n      b += data[index + 2]\n      count += 1\n    }\n  }\n  return [Math.floor(r / count), Math.floor(g / count), Math.floor(b / count)]\n}\n","/**\n * check if a color is dark\n */\nexport const isDarkColor = (rgb: [number, number, number]) => {\n  if (!rgb) {\n    throw new Error('rgb is required')\n  }\n  const [red, green, blue] = rgb\n  if (red < 0 || green < 0 || blue < 0) {\n    throw new Error('rgb values must be greater than or equal to zero')\n  }\n  if (red > 255 || green > 255 || blue > 255) {\n    throw new Error('rgb values must be less than or equal to 255')\n  }\n  return red * 0.299 + green * 0.587 + blue * 0.114 < 160\n}\n"],"names":["images","name","url","imageHeightPx","window","innerWidth","_useState","useState","_useState2","_slicedToArray","currentTab","setCurrentTab","_useState3","_useState4","isDarkBgColor","setIsDarkBgColor","_useState5","_useState6","averageColor","setAverageColor","tabRef","useRef","bgImageMaskRef","navbarRef","getAverageColorAndDetectDark","index","Promise","resolve","reject","xhr","XMLHttpRequest","onload","reader","FileReader","onloadend","result","readAsDataURL","response","onerror","e","console","error","open","responseType","send","then","dataUri","imgElement","document","createElement","src","average","img","canvas","width","height","context","getContext","drawImage","data","getImageData","r","g","b","count","y","x","Math","floor","getAverageColor","rgb","Error","_rgb","red","green","blue","isDarkColor","useEffect","addEventListener","current","threshold","scrollTop","documentElement","body","style","opacity","concat","navBarHeightPx","_jsxs","backgroundColor","children","_jsx","className","styles","color","ref","backgroundImage","top","item","onClick","halfScreenWidth","currentTabHalfWidth","offsetWidth","left","offsetLeft","scroll","behavior","handleClickTab","type","map"],"sourceRoot":""}